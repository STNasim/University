library(dplyr)

data("iris")

iris %>% group_by(Species) %>% summarise(mean_Largo_petalo = mean(Petal.Length))
select(iris, )

#iris <- iris %>% rename(Largo_Petalo=Petal.Length)

head(iris)


library(ggplot2)

table(iris$Species) %>% barplot(col = "blue", main = "Cantidad de plantas por especies")

plot(iris$Petal.Length, iris$Petal.Width, xlab = "Largo de pétalo",
     ylab = "Ancho de pétalo", main = "Largo vs Ancho", col = iris$Species)
legend("bottomright", legend = unique(iris$Species), col = 1:3, pch = 19, bty = "n")

boxplot(iris$Petal.Length, iris$Petal.Width, col = "blue", names = c("Largo", "Ancho"),
        main = "Boxplots Largo y Ancho")

boxplot(iris$Petal.Length~iris$Species, col = 1:3, 
        main = "Largo de pétalo por especie",
        xlab = "Especie",
        ylab = "Largo del pétalo")
legend("bottomright", legend = unique(iris$Species), col = 1:3, pch = 19, bty = "n")

lista <- list(seq(1, 10,2), )
lista[[2]] <- iris
lista


pdf(file = "/home/atilio/Escritorio/imagen.pdf")

graphic <- ggplot(data = iris) + aes(x = Petal.Length, y = Petal.Width)
graphic <- graphic + geom_point(aes(color = Species)) +
  geom_smooth()
graphic <- graphic + scale_x_continuous(breaks = seq(0, 7, 0.5), limits = c(0, 7)) +
  scale_y_continuous(breaks = seq(0, 2.5, 0.25), limits = c(0, 2.5)) +
  scale_color_manual(breaks = c("setosa", "versicolor", "virginica"),
                     values = c("black", "cyan", "red"),
                     labels = c("Setosa", "Versicolor", "Virginica"))
graphic <- graphic +  labs(x = "Largo de pétalo",
                           y = "Ancho de pétalo",
                           title = "Ancho vs largo de pétalo",
                           subtitle = "Se muestra el ancho vs el largo de pétalo para las tres especies de iris",
                           caption = "Seminario NGS", color = "Especie")
graphic <- graphic + theme(legend.background = element_blank(), 
                           legend.position = "bottom", 
                           plot.title = element_text(hjust = 0.5),
                           plot.subtitle = element_text(hjust = 0.5),
                           panel.grid = element_blank(),
                           panel.background = element_blank(),
                           panel.border = element_rect(colour = "black", fill = NA, size = 2))
graphic
dev.off()